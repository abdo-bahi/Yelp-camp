<% layout("layouts/boilerplate")%>
<div><h1>Hi <%=name%>  this is your <%=sessionCount%> e time visiting us check out these Campgrounds :</h1></div>

<div class="row" >  
  <div id="map" class="col-8 mb-3"></div>
</div>

<%for(let camp of camps){%>
  <div class="row g-2">
    <div class="col-10">
<div class="card mb-3" >
  <div class="row g-2">
    <div class="col-4">
      <% if(camp.images[0]) { %> 
              <img src="<%=camp.images[0].url%>" class="img-fluid" alt="" />
      <% } %>
    </div>
    <div class="col-6">
      <div class="card-body">
        <h5 class="card-title"><%=camp.title%></h5>
        <p class="card-text">located in : <%=camp.location%></p>
        <a href="/campground/<%=camp._id%>" class="btn btn-primary">Discover</a>
      </div>
    </div>
  </div>
</div>
</div>
</div>
<%}%>

<script>
var camps = <%- JSON.stringify(camps) %>;
document.addEventListener("DOMContentLoaded", function () {

  const map = L.map('map').setView([40.66995747, -103.59179687498357], 3.5);


  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '&copy; OpenStreetMap contributors'
  }).addTo(map);
  // L.marker([36.428293, 2.883504]).addTo(map);
  var markers = new L.MarkerClusterGroup();
  // const campChrea = camps[50];
  // markers.addLayer(L.marker([36.428293, 2.883504]));
camps.forEach(camp => {
  if (camp.longitude && camp.latitude) {
      const marker = L.marker([camp.latitude, camp.longitude]);
    marker.bindPopup(`
    <div>
      <h6>${camp.title}</h6>
      <p>${camp.location}</p>
      <a href="/campground/${camp._id}">View Camp</a>
    </div>
  `);
    markers.addLayer(marker);
  }
 });

//  markers.addLayer(L.marker([campChrea.longitude, campChrea.latitude]));

map.addLayer(markers);
 });

console.log(camps);

</script>
